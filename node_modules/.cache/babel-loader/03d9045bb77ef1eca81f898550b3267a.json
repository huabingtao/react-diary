{"ast":null,"code":"var _jsxFileName = \"/Users/hbt/MyProject/gitHub/react-diary/src/views/write-diary.jsx\";\nimport React from 'react';\nimport axios from '../utils/request';\nimport { TextareaItem, Toast } from 'antd-mobile';\n\nfunction Header(props) {\n  const style = {\n    wrap: {\n      display: 'flex',\n      color: '#fff',\n      fontSize: '1.2rem',\n      height: '3rem',\n      justifyContent: 'space-between',\n      alignItems: 'center',\n      padding: '0 1rem',\n      background: '#53a6db'\n    },\n    cancel: {\n      color: '#0e80d2'\n    }\n  };\n  return React.createElement(\"div\", {\n    style: style.wrap,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 23\n    },\n    __self: this\n  }, React.createElement(\"span\", {\n    onClick: props.onClickCancel,\n    style: style.cancel,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 24\n    },\n    __self: this\n  }, \"\\u53D6\\u6D88\"), React.createElement(\"span\", {\n    onClick: props.onClickConfirm,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 27\n    },\n    __self: this\n  }, \"\\u53D1\\u5E03\"));\n}\n\nclass WriteDiary extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      content: ''\n    };\n  }\n\n  componentDidMount() {\n    this.autoFocusInst.focus();\n\n    if (!this.props.location.state) {\n      return;\n    }\n\n    const {\n      content,\n      uid,\n      id\n    } = this.props.location.state.diaryDetail;\n    this.setState({\n      uid,\n      id,\n      content\n    });\n  }\n\n  async onClickConfirm() {\n    const {\n      content,\n      id,\n      uid\n    } = this.state;\n    const user = JSON.parse(window.localStorage.getItem('user'));\n\n    if (id) {\n      await axios.put('/diary/', {\n        uid,\n        id,\n        content\n      });\n      Toast.success('编辑成功', 1.5, _ => {\n        this.props.history.goBack();\n      });\n    } else {\n      await axios.post('/diary/', {\n        id: user.id,\n        content\n      });\n      Toast.success('发布成功', 1.5, _ => {\n        this.props.history.goBack();\n      });\n    }\n  }\n\n  onChange(value) {\n    this.setState({\n      content: value\n    });\n  }\n\n  onClickCancel() {\n    this.props.history.goBack();\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84\n      },\n      __self: this\n    }, React.createElement(Header, {\n      onClickCancel: this.onClickCancel.bind(this),\n      onClickConfirm: this.onClickConfirm.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85\n      },\n      __self: this\n    }), React.createElement(TextareaItem, {\n      rows: \"16\",\n      value: this.state.content,\n      placeholder: \"\\u4ECE\\u524D\\u8F66\\u9A6C\\u5F88\\u6162\\u4E66\\u4FE1\\u5F88\\u8FDC\\u4E00\\u751F\\u53EA\\u591F\\u7231\\u4E00\\u4E2A\\u4EBA\",\n      ref: el => this.autoFocusInst = el,\n      count: \"2000\",\n      onChange: this.onChange.bind(this),\n      autoHeight: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89\n      },\n      __self: this\n    }));\n  }\n\n}\n\nexport default WriteDiary;","map":{"version":3,"sources":["/Users/hbt/MyProject/gitHub/react-diary/src/views/write-diary.jsx"],"names":["React","axios","TextareaItem","Toast","Header","props","style","wrap","display","color","fontSize","height","justifyContent","alignItems","padding","background","cancel","onClickCancel","onClickConfirm","WriteDiary","Component","constructor","state","content","componentDidMount","autoFocusInst","focus","location","uid","id","diaryDetail","setState","user","JSON","parse","window","localStorage","getItem","put","success","_","history","goBack","post","onChange","value","render","bind","el"],"mappings":"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","sourcesContent":["import React from 'react'\nimport axios from '../utils/request'\nimport { TextareaItem, Toast } from 'antd-mobile'\n\nfunction Header(props) {\n  const style = {\n    wrap: {\n      display: 'flex',\n      color: '#fff',\n      fontSize: '1.2rem',\n      height: '3rem',\n      justifyContent: 'space-between',\n      alignItems: 'center',\n      padding: '0 1rem',\n      background: '#53a6db'\n    },\n    cancel: {\n      color: '#0e80d2'\n    }\n  }\n\n  return (\n    <div style={style.wrap}>\n      <span onClick={props.onClickCancel} style={style.cancel}>\n        取消\n      </span>\n      <span onClick={props.onClickConfirm}>发布</span>\n    </div>\n  )\n}\nclass WriteDiary extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      content: ''\n    }\n  }\n  componentDidMount() {\n    this.autoFocusInst.focus()\n    if (!this.props.location.state) {\n      return\n    }\n    const { content, uid, id } = this.props.location.state.diaryDetail\n    this.setState({\n      uid,\n      id,\n      content\n    })\n  }\n\n  async onClickConfirm() {\n    const { content, id, uid } = this.state\n    const user = JSON.parse(window.localStorage.getItem('user'))\n    if (id) {\n      await axios.put('/diary/', {\n        uid,\n        id,\n        content\n      })\n      Toast.success('编辑成功', 1.5, _ => {\n        this.props.history.goBack()\n      })\n    } else {\n      await axios.post('/diary/', {\n        id: user.id,\n        content\n      })\n      Toast.success('发布成功', 1.5, _ => {\n        this.props.history.goBack()\n      })\n    }\n  }\n  onChange(value) {\n    this.setState({\n      content: value\n    })\n  }\n  onClickCancel() {\n    this.props.history.goBack()\n  }\n\n  render() {\n    return (\n      <div>\n        <Header\n          onClickCancel={this.onClickCancel.bind(this)}\n          onClickConfirm={this.onClickConfirm.bind(this)}\n        ></Header>\n        <TextareaItem\n          rows=\"16\"\n          value={this.state.content}\n          placeholder=\"从前车马很慢书信很远一生只够爱一个人\"\n          ref={el => (this.autoFocusInst = el)}\n          count=\"2000\"\n          onChange={this.onChange.bind(this)}\n          autoHeight\n        />\n      </div>\n    )\n  }\n}\n\nexport default WriteDiary\n"]},"metadata":{},"sourceType":"module"}