{"ast":null,"code":"import _regeneratorRuntime from\"/Users/hbt/MyProject/gitHub/react-diary/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/hbt/MyProject/gitHub/react-diary/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/hbt/MyProject/gitHub/react-diary/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/hbt/MyProject/gitHub/react-diary/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/hbt/MyProject/gitHub/react-diary/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/hbt/MyProject/gitHub/react-diary/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/hbt/MyProject/gitHub/react-diary/node_modules/@babel/runtime/helpers/esm/inherits\";import React from'react';import axios from'../utils/request';import{TextareaItem,Toast}from'antd-mobile';function Header(props){var style={wrap:{display:'flex',color:'#fff',fontSize:'1.2rem',height:'3rem',justifyContent:'space-between',alignItems:'center',padding:'0 1rem',background:'#53a6db'},cancel:{color:'#0e80d2'}};return React.createElement(\"div\",{style:style.wrap},React.createElement(\"span\",{onClick:props.onClickCancel,style:style.cancel},\"\\u53D6\\u6D88\"),React.createElement(\"span\",{onClick:props.onClickConfirm},\"\\u53D1\\u5E03\"));}var WriteDiary=/*#__PURE__*/function(_React$Component){_inherits(WriteDiary,_React$Component);function WriteDiary(props){var _this;_classCallCheck(this,WriteDiary);_this=_possibleConstructorReturn(this,_getPrototypeOf(WriteDiary).call(this,props));_this.state={content:''};return _this;}_createClass(WriteDiary,[{key:\"componentDidMount\",value:function componentDidMount(){this.autoFocusInst.focus();if(!this.props.location.state){return;}var _this$props$location$=this.props.location.state.diaryDetail,content=_this$props$location$.content,uid=_this$props$location$.uid,id=_this$props$location$.id;this.setState({uid:uid,id:id,content:content});}},{key:\"onClickConfirm\",value:function(){var _onClickConfirm=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _this2=this;var _this$state,content,id,uid,user;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_this$state=this.state,content=_this$state.content,id=_this$state.id,uid=_this$state.uid;user=JSON.parse(window.localStorage.getItem('user'));if(!id){_context.next=8;break;}_context.next=5;return axios.put('/diary/',{uid:uid,id:id,content:content});case 5:Toast.success('编辑成功',1.5,function(_){_this2.props.history.goBack();});_context.next=11;break;case 8:_context.next=10;return axios.post('/diary/',{id:user.id,content:content});case 10:Toast.success('发布成功',1.5,function(_){_this2.props.history.goBack();});case 11:case\"end\":return _context.stop();}}},_callee,this);}));function onClickConfirm(){return _onClickConfirm.apply(this,arguments);}return onClickConfirm;}()},{key:\"onChange\",value:function onChange(value){this.setState({content:value});}},{key:\"onClickCancel\",value:function onClickCancel(){this.props.history.goBack();}},{key:\"render\",value:function render(){var _this3=this;return React.createElement(\"div\",null,React.createElement(Header,{onClickCancel:this.onClickCancel.bind(this),onClickConfirm:this.onClickConfirm.bind(this)}),React.createElement(TextareaItem,{rows:\"16\",value:this.state.content,placeholder:\"\\u4ECE\\u524D\\u8F66\\u9A6C\\u5F88\\u6162\\u4E66\\u4FE1\\u5F88\\u8FDC\\u4E00\\u751F\\u53EA\\u591F\\u7231\\u4E00\\u4E2A\\u4EBA\",ref:function ref(el){return _this3.autoFocusInst=el;},count:\"2000\",onChange:this.onChange.bind(this),autoHeight:true}));}}]);return WriteDiary;}(React.Component);export default WriteDiary;","map":{"version":3,"sources":["/Users/hbt/MyProject/gitHub/react-diary/src/views/write-diary.jsx"],"names":["React","axios","TextareaItem","Toast","Header","props","style","wrap","display","color","fontSize","height","justifyContent","alignItems","padding","background","cancel","onClickCancel","onClickConfirm","WriteDiary","state","content","autoFocusInst","focus","location","diaryDetail","uid","id","setState","user","JSON","parse","window","localStorage","getItem","put","success","_","history","goBack","post","value","bind","el","onChange","Component"],"mappings":"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","sourcesContent":["import React from 'react'\nimport axios from '../utils/request'\nimport { TextareaItem, Toast } from 'antd-mobile'\n\nfunction Header(props) {\n  const style = {\n    wrap: {\n      display: 'flex',\n      color: '#fff',\n      fontSize: '1.2rem',\n      height: '3rem',\n      justifyContent: 'space-between',\n      alignItems: 'center',\n      padding: '0 1rem',\n      background: '#53a6db'\n    },\n    cancel: {\n      color: '#0e80d2'\n    }\n  }\n\n  return (\n    <div style={style.wrap}>\n      <span onClick={props.onClickCancel} style={style.cancel}>\n        取消\n      </span>\n      <span onClick={props.onClickConfirm}>发布</span>\n    </div>\n  )\n}\nclass WriteDiary extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      content: ''\n    }\n  }\n  componentDidMount() {\n    this.autoFocusInst.focus()\n    if (!this.props.location.state) {\n      return\n    }\n    const { content, uid, id } = this.props.location.state.diaryDetail\n    this.setState({\n      uid,\n      id,\n      content\n    })\n  }\n\n  async onClickConfirm() {\n    const { content, id, uid } = this.state\n    const user = JSON.parse(window.localStorage.getItem('user'))\n    if (id) {\n      await axios.put('/diary/', {\n        uid,\n        id,\n        content\n      })\n      Toast.success('编辑成功', 1.5, _ => {\n        this.props.history.goBack()\n      })\n    } else {\n      await axios.post('/diary/', {\n        id: user.id,\n        content\n      })\n      Toast.success('发布成功', 1.5, _ => {\n        this.props.history.goBack()\n      })\n    }\n  }\n  onChange(value) {\n    this.setState({\n      content: value\n    })\n  }\n  onClickCancel() {\n    this.props.history.goBack()\n  }\n\n  render() {\n    return (\n      <div>\n        <Header\n          onClickCancel={this.onClickCancel.bind(this)}\n          onClickConfirm={this.onClickConfirm.bind(this)}\n        ></Header>\n        <TextareaItem\n          rows=\"16\"\n          value={this.state.content}\n          placeholder=\"从前车马很慢书信很远一生只够爱一个人\"\n          ref={el => (this.autoFocusInst = el)}\n          count=\"2000\"\n          onChange={this.onChange.bind(this)}\n          autoHeight\n        />\n      </div>\n    )\n  }\n}\n\nexport default WriteDiary\n"]},"metadata":{},"sourceType":"module"}